# 🚀 프로젝트 시작 가이드

## 1단계: 환경 설정 확인

### ✅ 필요한 것들
- [ ] Python 3.8 이상 설치됨
- [ ] Google Cloud Platform 계정
- [ ] GCS 버킷 생성 및 음악 파일 업로드 완료
- [ ] OpenAI API 키 발급 완료
- [ ] GCS 서비스 계정 키 파일 다운로드 완료

## 2단계: 가상환경 활성화

```bash
# Windows
venv\Scripts\activate

# 활성화되면 프롬프트 앞에 (venv)가 표시됩니다
```

## 3단계: 의존성 설치

```bash
cd gcs-music-streaming
pip install -r requirements.txt
```

## 4단계: 환경 변수 설정

### 4-1. .env 파일 생성

```bash
# .env.example을 복사해서 .env 파일 생성
copy .env.example .env
```

### 4-2. .env 파일 편집

`.env` 파일을 열어서 다음 정보를 입력하세요:

```env
# OpenAI API 키 (필수)
OPENAI_API_KEY=sk-proj-여기에-실제-키-입력

# GCS 버킷 이름 (필수)
GCS_BUCKET_NAME=여기에-버킷-이름-입력

# GCS 서비스 계정 키 파일 경로 (필수, 절대 경로)
GOOGLE_APPLICATION_CREDENTIALS=C:\경로\서비스계정키.json

# 서버 설정 (선택사항, 기본값 사용 가능)
PORT=5001
HOST=0.0.0.0
CORS_ORIGINS=*
```

## 5단계: GCS 파일 목록 생성

```bash
python generate_file_list.py
```

이 명령어는 GCS 버킷에서 모든 MP3 파일 목록을 가져와서 `gcs_music_files.json` 파일에 저장합니다.

**⚠️ 중요**: GCS 버킷에 새 음악 파일을 추가한 후에는 이 명령어를 다시 실행해야 합니다.

## 6단계: GCS 연결 테스트 (선택사항)

```bash
python test_gcs_connection.py
```

이 명령어로 GCS 연결과 인증이 제대로 작동하는지 확인할 수 있습니다.

## 7단계: 서버 실행

```bash
python music_service_gcs.py
```

서버가 성공적으로 시작되면 다음과 같은 메시지가 표시됩니다:
```
 * Running on http://0.0.0.0:5001
```

## 8단계: 테스트

### 브라우저에서 테스트
1. 브라우저에서 `http://localhost:5001` 접속
2. 또는 `music_test_client.html` 파일을 직접 열기
3. 씬 설명을 입력하고 "음악 추천 받기" 버튼 클릭

### API 테스트
```bash
# API 엔드포인트 테스트
python test_api.py

# 또는 curl 사용
curl -X POST http://localhost:5001/api/analyze ^
  -H "Content-Type: application/json" ^
  -d "{\"prompt\": \"주인공이 숲 속을 탐험한다\"}"
```

## 🔧 문제 해결

### "GCS client creation failed" 오류
- `.env` 파일의 `GOOGLE_APPLICATION_CREDENTIALS` 경로가 올바른지 확인
- 서비스 계정 키 파일이 실제로 존재하는지 확인
- 서비스 계정에 `Storage Object Viewer` 권한이 있는지 확인

### "No files found for mood" 오류
- `python generate_file_list.py` 실행하여 파일 목록 갱신
- GCS 버킷에 음악 파일이 올바른 폴더에 있는지 확인
- `music_service_gcs.py`의 `MUSIC_LIBRARY` 폴더 이름과 GCS 폴더 이름이 일치하는지 확인

### "ModuleNotFoundError" 오류
```bash
# 가상환경이 활성화되어 있는지 확인
# requirements.txt 다시 설치
pip install -r requirements.txt
```

## 📝 다음 단계

서버가 정상적으로 실행되면:
1. API 엔드포인트를 사용하여 다른 애플리케이션과 통합
2. `MUSIC_LIBRARY`를 수정하여 새로운 무드 카테고리 추가
3. GPT 프롬프트를 조정하여 분석 정확도 개선

## 📚 참고 문서

- `README.md` - 전체 프로젝트 설명
- `CLAUDE.md` - 개발자를 위한 상세 기술 문서
- API 엔드포인트: `GET /api/health`, `GET /api/moods`, `POST /api/analyze`









